# 海量数据处理

## 海量数据排序

- 题目特点：
  - 需要排序的文件超大，可以认为内存放不下，比如 100GB，1TB 的文件。如果你家电脑的内存有 1TB，那你可以把测试文件调整为 1PB。
  - 文件内容可以是以空格分隔，或者是按行分隔。
  - 文件内容可以是整数、浮点数、字符串等，只要是可以排序的就行。
  - 可以是从小到大排序，也可以是从大到小排序。
- 例题：
  - 例题一：按照从小到大给 100GB 的文件进行排序，文件里面是以空格分隔的 float64 类型的浮点数。
  - 例题二：按照从大到小给 1TB 的文件排序，文件里面是每行一个字符串。
  - 例题三：按照从小到大给 10GB 的文件进行排序，文件里面是每行一个 int32 类型的整数。
- 解题思路：
  - 以例题三举例说明，文件大小是 10GB。
  - 假设输入文件名为 input.bin。
  - 假设内存有 2GB 可以使用。
  - 我们从 input.bin 中每次读取大约 1GB 的数据到内存中进行处理。
    - 我们在内存中对 1GB 的数据使用快速排序进行排序。
    - 把排序好的的 1GB 数据写入文件 xx.bin 中。
    - 一共会得到 10 个排序好的文件 01.bin, 02.bin, ..., 09.bin, 10.bin。
  - 对 10 个排序好的文件进行合并。
    - 把 10 个文件都打开，得到 10 个文件句柄。
    - 从 10 个文件句柄中各自读取出一个整数，对比这 10 个整数。
    - 把最小的整数写入 output.bin，同时最小的整数对应的文件句柄向后移动。
  - 最后生成的 output.bin 就是排序好的文件。
